---
default_package_name: "github.com/gravitational/teleport/api/types"
target_package_name: "tfschema"
custom_duration: "github.com/gravitational/teleport/api/types.Duration"
sort: true
use_json_tag: true

# Top-level type names to export
types:
    - "UserV2"
    - "RoleV4"
    - "ProvisionTokenV2"    
    # - "GithubConnectorV3"
    # - "SAMLConnectorV2"
    # - "OIDCConnectorV2"
    # - "TrustedClusterV2"

# These fields will be excluded
exclude_fields:
    # Metadata (we id resources by name on our side)
    - "Metadata.ID"
    
    # User
    - "UserSpecV2.LocalAuth" # We do not need to set user auth data
    - "UserSpecV2.Expires"   # Those fields are Teleport side meta, we do not need to change them via Terraform
    - "UserSpecV2.CreatedBy"
    - "UserSpecV2.Status"

    # Role
    - "RoleV3.Spec.Allow.Namespaces" # These fields are not settable via API
    - "RoleV3.Spec.Deny.Namespaces"

# These fields will be marked as Computed: true
computed_fields:

# These fields will be marked as Required: true 
required_fields:
    # Metadata
    - "Metadata.Name"

    # Role
    - "RoleV3.Spec"
    
    # Provision token
    - "ProvisionTokenV2.Spec"
    # This field is required because it is non-empty by default. It can't be Computed because in this case
    # user would not be able to reset all nested fields to default values. If user sets an empty Computed field
    # to empty, it keeps it's last value in the state and never gets reset to default value or deleted. 
    # So, it's a workaround.
    - "ProvisionTokenV2.Spec.Options"
    - "ProvisionTokenV2.Spec.Roles"
    - "ProvisionTokenV2.Metadata.Expires"

    # Github connector
    - "GithubConnectorV3.Spec"
    - "GithubConnectorV3.Spec.ClientID"
    - "GithubConnectorV3.Spec.ClientSecret"
    - "GithubConnectorV3.Spec.TeamsToLogins"
    - "GithubConnectorV3.Spec.TeamsToLogins.Team"
    - "GithubConnectorV3.Spec.TeamsToLogins.Logins"

    # SAML connector
    - "SAMLConnectorV2.Spec"
    - "SAMLConnectorV2.Spec.AssertionConsumerService"
    - "SAMLConnectorV2.Spec.EntityDescriptor"
    - "SAMLConnectorV2.Spec.EntityDescriptorURL"

    # OIDC connector
    - "OIDCConnectorV2.Spec"

# These fields must be marked as sensitive
sensitive_fields:
    - "ProvisionTokenV2.Metadata.Name"

# These suffixes for custom methods called when field has custom_type flag. By default they might be weird.
suffixes:
    "BoolOption": "BoolOption" # This is listed here for convenience. Just to have all custom method names in a single place.
    "Labels": "Labels"
    "github.com/gravitational/teleport/api/types/wrappers.Traits": "Traits"

# Custom validators
validators:
    "Metadata.Expires":
        - "validateTimeFormatRFC3339"

# Time custom type
time_type:
  type: "TimeType"            # Implementation of attrs.Type
  value_type: "TimeValue"     # Implementation of attrs.Value
  cast_type: "time.Time"      # Go type of .Value

# Duration custom type
duration_type:
  type: "DurationType"        # Implementation of attrs.Type
  value_type: "DurationValue" # Implementation of attrs.Value
  cast_type: "time.Duration"  # Go type of .Value

